import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as p,o as l,c as o,b as n,d as a,e,a as t}from"./app-CshvniiL.js";const c={},r=t(`<p>云平台主要采用的技术如下：</p><table><thead><tr><th>名称</th><th>简介</th></tr></thead><tbody><tr><td>Docker</td><td>应用容器引擎，从而实现同一应用运行在任何地方</td></tr><tr><td>Kubernetes</td><td>容器化编排工具，能够实现容器化的集群部署</td></tr><tr><td>Rancher</td><td>Kubernetes 管理工具，能够快速搭建高可用 Kubernetes 和搭建部分常用服务</td></tr><tr><td>Harbor</td><td>私有镜像仓库</td></tr><tr><td>Jenkins</td><td>持续集成工具</td></tr></tbody></table><h2 id="环境准备" tabindex="-1"><a class="header-anchor" href="#环境准备"><span>环境准备</span></a></h2><h3 id="_1-关闭防火墙" tabindex="-1"><a class="header-anchor" href="#_1-关闭防火墙"><span>1.关闭防火墙</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### 停止防火墙</span>
systemctl stop firewalld.service
<span class="token comment">### 禁止开机启动</span>
systemctl disable firewalld.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-更新-yum" tabindex="-1"><a class="header-anchor" href="#_2-更新-yum"><span>2.更新 yum</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>yum update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_3-安装工具" tabindex="-1"><a class="header-anchor" href="#_3-安装工具"><span>3.安装工具</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils device-mapper-persistent-data lvm2
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="安装-docker" tabindex="-1"><a class="header-anchor" href="#安装-docker"><span>安装 Docker</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### 添加Docker源</span>
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
<span class="token comment">### 更新yum</span>
yum update <span class="token parameter variable">-y</span>
<span class="token comment">### 安装Docker</span>
yum <span class="token function">install</span> <span class="token parameter variable">-y</span> docker-ce
<span class="token comment">### 启动Docker</span>
systemctl start <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_1-设置开机启动" tabindex="-1"><a class="header-anchor" href="#_1-设置开机启动"><span>1. 设置开机启动</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-使用阿里加速" tabindex="-1"><a class="header-anchor" href="#_2-使用阿里加速"><span>2.使用阿里加速</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### 使用阿里的容器镜像服务进行加速（个人加速器可更换）</span>
<span class="token comment">### Linux 加速</span>
<span class="token function">sudo</span> <span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/docker
<span class="token function">sudo</span> <span class="token function">tee</span> /etc/docker/daemon.json <span class="token operator">&lt;&lt;-</span><span class="token string">&#39;EOF&#39;
{
  &quot;registry-mirrors&quot;: [&quot;https://q47dgr1i.mirror.aliyuncs.com&quot;]
}
EOF</span>
<span class="token function">sudo</span> systemctl daemon-reload
<span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装-rancher" tabindex="-1"><a class="header-anchor" href="#安装-rancher"><span>安装 Rancher</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">### 拉取镜像</span>
<span class="token function">sudo</span> <span class="token function">docker</span> pull rancher/rancher
<span class="token comment">### 运行镜像</span>
<span class="token function">sudo</span> <span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--restart</span><span class="token operator">=</span>unless-stopped <span class="token parameter variable">-p</span> <span class="token number">8080</span>:80  <span class="token parameter variable">-p</span> <span class="token number">8443</span>:443 <span class="token parameter variable">--name</span> rancher rancher/rancher
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>如果映射端口为 80、443 可能会导致无法访问，更换端口即可</li></ul><h2 id="安装-kubernetes" tabindex="-1"><a class="header-anchor" href="#安装-kubernetes"><span>安装 Kubernetes</span></a></h2><h3 id="_1-创建集群" tabindex="-1"><a class="header-anchor" href="#_1-创建集群"><span>1.创建集群</span></a></h3><ul><li>添加集群<br><img src="https://img-blog.csdnimg.cn/img_convert/08b16a99f99d283943e901e6538175c9.png#id=DlN8G&amp;originHeight=429&amp;originWidth=3017&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" loading="lazy"></li><li>选择自定义，然后填写创建的配置，点击下一步</li><li><img src="https://img-blog.csdnimg.cn/img_convert/2c3d4296756fca322c8b4fa8f2d714ba.png#id=MIBAN&amp;originHeight=1648&amp;originWidth=3073&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>添加节点</li><li><img src="https://img-blog.csdnimg.cn/img_convert/917da469670cd455c0add3a09cad4f67.png#id=VjeVb&amp;originHeight=731&amp;originWidth=3009&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li></ul><h3 id="_2-安装-master" tabindex="-1"><a class="header-anchor" href="#_2-安装-master"><span>2.安装 master</span></a></h3><p>安装 master 节点，需要选择 Control<br> 然后复制执行命令在相应的主机执行命令即可</p><h3 id="_3-安装-node" tabindex="-1"><a class="header-anchor" href="#_3-安装-node"><span>3.安装 node</span></a></h3><p>只需要选择 work<br> 然后复制执行命令在相应的主机执行命令即可</p><h3 id="_4-笔记本合盖" tabindex="-1"><a class="header-anchor" href="#_4-笔记本合盖"><span>4.笔记本合盖</span></a></h3><p>需要设置合盖不影响，否则盒盖休眠就会影响该节点</p><h3 id="_5-主机名" tabindex="-1"><a class="header-anchor" href="#_5-主机名"><span>5.主机名</span></a></h3><p>若主机名重复，则可能导致无法做安装节点<br> 若 k8s.master k8s.node 他主机名显示的都为 k8s 导致无法添加</p><h2 id="rancher-cli-工具使用" tabindex="-1"><a class="header-anchor" href="#rancher-cli-工具使用"><span>Rancher-cli 工具使用</span></a></h2>`,30),u={href:"https://releases.rancher.com/cli2/v2.4.3/rancher-linux-amd64-v2.4.3.tar.gz",target:"_blank",rel:"noopener noreferrer"},d={href:"https://releases.rancher.com/cli2/v2.4.3/rancher-windows-386-v2.4.3.zip",target:"_blank",rel:"noopener noreferrer"},m={href:"https://releases.rancher.com/cli2/v2.4.3/rancher-darwin-amd64-v2.4.3.tar.gz",target:"_blank",rel:"noopener noreferrer"},k=t(`<h3 id="通过-ui-添加-token" tabindex="-1"><a class="header-anchor" href="#通过-ui-添加-token"><span>通过 UI 添加 token</span></a></h3><p><img src="https://img-blog.csdnimg.cn/img_convert/9fe828979b7ec9d3ca8aa68f3f4def65.png#id=TfICt&amp;originHeight=487&amp;originWidth=1400&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" loading="lazy"><br><img src="https://img-blog.csdnimg.cn/img_convert/c2354ae8e881435897dd9416e058cd7c.png#id=jX3Bn&amp;originHeight=640&amp;originWidth=3019&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" loading="lazy"><br><img src="https://img-blog.csdnimg.cn/img_convert/4d10fe0ab8bf67f05ec54be4405f760a.png#id=rRBSm&amp;originHeight=673&amp;originWidth=1175&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" loading="lazy"></p><h3 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 进入解压包中，使用命令即可登录rancher</span>
./rancher login https://172.22.190.240:8443/v3 <span class="token parameter variable">-t</span> token-d7sx4:jh2wgcjjnmvq7m9l9rbr8qdw5fr7nrd2bjssjfngmcjrsxncdphf7d
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>需要下载<code>kubectl</code>工具对<code>kubernetes</code>进行操作</p><h3 id="安装-kubectl" tabindex="-1"><a class="header-anchor" href="#安装-kubectl"><span>安装 kubectl</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 1. 配置阿里云源</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">&gt;</span> /etc/yum.repos.d/kubernetes.repo</span>
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64
enabled=1
gpgcheck=0
EOF</span>

<span class="token comment"># 2. 开始安装</span>
yum <span class="token parameter variable">-y</span> <span class="token function">install</span>  kubectl
<span class="token comment"># 3. 测试 查看节点</span>
./rancher kubectl get nodes
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="安装-harbor" tabindex="-1"><a class="header-anchor" href="#安装-harbor"><span>安装 Harbor</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 1. 下载安装文件（可以在指定目录下载）</span>
<span class="token function">wget</span> https://storage.googleapis.com/harbor-releases/harbor-online-installer-v1.5.2.tgz

<span class="token comment"># 2. 解压下载的文件</span>
<span class="token function">tar</span> xvf harbor-online-installer-v1.5.2.tgz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置-harbor" tabindex="-1"><a class="header-anchor" href="#配置-harbor"><span>配置 Harbor</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token number">1</span>. 修改Harbor的配置文件
<span class="token builtin class-name">cd</span> harbor
<span class="token function">vim</span> harbor.cfg

内容如下：

<span class="token comment"># hostname设置访问地址，可以使用ip、域名，不可以设置为127.0.0.1或localhost</span>
<span class="token function">hostname</span> <span class="token operator">=</span> hub.k8s.com

<span class="token comment"># 访问协议，默认是http，也可以设置https，如果设置https，则nginx ssl需要设置on</span>
ui_url_protocol <span class="token operator">=</span> http

<span class="token comment"># mysql数据库root用户默认密码root123，实际使用时修改下</span>
db_password <span class="token operator">=</span> root@1234

max_job_workers <span class="token operator">=</span> <span class="token number">3</span>
customize_crt <span class="token operator">=</span> on
ssl_cert <span class="token operator">=</span> /data/cert/server.crt
ssl_cert_key <span class="token operator">=</span> /data/cert/server.key
secretkey_path <span class="token operator">=</span> /data
admiral_url <span class="token operator">=</span> NA

<span class="token comment"># 邮件设置，发送重置密码邮件时使用</span>
email_identity <span class="token operator">=</span>
email_server <span class="token operator">=</span> smtp.mydomain.com
email_server_port <span class="token operator">=</span> <span class="token number">25</span>
email_username <span class="token operator">=</span> sample_admin@mydomain.com
email_password <span class="token operator">=</span> abc
email_from <span class="token operator">=</span> admin <span class="token operator">&lt;</span>sample_admin@mydomain.com<span class="token operator">&gt;</span>
email_ssl <span class="token operator">=</span> <span class="token boolean">false</span>

<span class="token comment"># 启动Harbor后，管理员UI登录的密码，默认是Harbor12345</span>
harbor_admin_password <span class="token operator">=</span> root@1234

<span class="token comment"># 认证方式，这里支持多种认证方式，如LADP、本次存储、数据库认证。默认是db_auth，mysql数据库认证</span>
auth_mode <span class="token operator">=</span> db_auth

<span class="token comment"># LDAP认证时配置项</span>
<span class="token comment">#ldap_url = ldaps://ldap.mydomain.com</span>
<span class="token comment">#ldap_searchdn = uid=searchuser,ou=people,dc=mydomain,dc=com</span>
<span class="token comment">#ldap_search_pwd = password</span>
<span class="token comment">#ldap_basedn = ou=people,dc=mydomain,dc=com</span>
<span class="token comment">#ldap_filter = (objectClass=person)</span>
<span class="token comment">#ldap_uid = uid</span>
<span class="token comment">#ldap_scope = 3</span>
<span class="token comment">#ldap_timeout = 5</span>

<span class="token comment"># 是否开启自注册</span>
self_registration <span class="token operator">=</span> on

<span class="token comment"># Token有效时间，默认30分钟</span>
token_expiration <span class="token operator">=</span> <span class="token number">30</span>

<span class="token comment"># 用户创建项目权限控制，默认是everyone（所有人），也可以设置为adminonly（只能管理员）</span>
project_creation_restriction <span class="token operator">=</span> everyone

verify_remote_cert <span class="token operator">=</span> on
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="启动-harbor" tabindex="-1"><a class="header-anchor" href="#启动-harbor"><span>启动 Harbor</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 1.在当前安装目录下</span>
./install.sh
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="注意" tabindex="-1"><a class="header-anchor" href="#注意"><span>注意</span></a></h3>`,14),v={href:"http://install.sh",target:"_blank",rel:"noopener noreferrer"},b=t(`<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>root@ubuntu:~/harbor<span class="token comment"># ./prepare</span>
Generated and saved secret to file: /data/secretkey
Generated configuration file: ./common/config/nginx/nginx.conf
Generated configuration file: ./common/config/adminserver/env
Generated configuration file: ./common/config/ui/env
Generated configuration file: ./common/config/registry/config.yml
Generated configuration file: ./common/config/db/env
Generated configuration file: ./common/config/jobservice/env
Generated configuration file: ./common/config/jobservice/config.yml
Generated configuration file: ./common/config/log/logrotate.conf
Generated configuration file: ./common/config/jobservice/config.yml
Generated configuration file: ./common/config/ui/app.conf
Fail to generate key file: ./common/config/ui/private_key.pem, cert file: ./common/config/registry/root.crt
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>需要修改 prepare 文件，将第 498 行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>empty_subj <span class="token operator">=</span> <span class="token string">&quot;/C=/ST=/L=/O=/CN=/&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>修改如下：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>empty_subj <span class="token operator">=</span> <span class="token string">&quot;/C=US/ST=California/L=Palo Alto/O=VMware, Inc./OU=Harbor/CN=notarysigner&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="安装-jenkins" tabindex="-1"><a class="header-anchor" href="#安装-jenkins"><span>安装 Jenkins</span></a></h2><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">wget</span> <span class="token parameter variable">-O</span> /etc/yum.repos.d/jenkins.repo https://pkg.jenkins.io/redhat-stable/jenkins.repo
<span class="token function">sudo</span> <span class="token function">rpm</span> <span class="token parameter variable">--import</span> https://pkg.jenkins.io/redhat-stable/jenkins.io.key
yum <span class="token function">install</span> jenkins
<span class="token comment">## 启动</span>
systemctl restart jenkins
<span class="token comment">## 密码</span>
<span class="token function">cat</span> /var/lib/jenkins/secrets/initialAdminPassowrd
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="提升权限" tabindex="-1"><a class="header-anchor" href="#提升权限"><span>提升权限</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 将jenkins账号分别加入到root组中</span>
gpasswd <span class="token parameter variable">-a</span> root jenkins
<span class="token function">vi</span> /etc/sysconfig/jenkins
<span class="token comment"># JENKINS_USER=root</span>
<span class="token comment"># JENKINS_GROUP=root</span>
<span class="token comment">## 重启</span>
<span class="token function">service</span> Jenkins restart
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="设置环境" tabindex="-1"><a class="header-anchor" href="#设置环境"><span>设置环境</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment">## 下载java</span>
<span class="token function">wget</span> --no-cookies --no-check-certificate <span class="token parameter variable">--header</span> <span class="token string">&quot;Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie&quot;</span> <span class="token string">&quot;http://download.oracle.com/otn-pub/java/jdk/8u141-b15/336fa29ff2bb4ef291e347e091f7f4a7/jdk-8u141-linux-x64.tar.gz&quot;</span>
<span class="token comment">## 下载maven</span>
<span class="token function">wget</span> https://archive.apache.org/dist/maven/maven-3/3.5.0/binaries/apache-maven-3.5.0-bin.tar.gz
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置-jenkins-插件工具" tabindex="-1"><a class="header-anchor" href="#配置-jenkins-插件工具"><span>配置 Jenkins 插件工具</span></a></h3><p>Manage Jenkins --- &gt; Global Tool Configure<br><img src="https://img-blog.csdnimg.cn/img_convert/ef906bee1b727ee324f4980ecce5ea07.png#id=uPRzP&amp;originHeight=1891&amp;originWidth=3511&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" loading="lazy"></p><h3 id="设置流水线" tabindex="-1"><a class="header-anchor" href="#设置流水线"><span>设置流水线</span></a></h3><ul><li>新建 Item</li><li><img src="https://img-blog.csdnimg.cn/img_convert/d138925af8b3793e0f702bbf3a96b8b3.png#id=pvaOC&amp;originHeight=587&amp;originWidth=383&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>选择创建任务的类型和名称</li><li><img src="https://img-blog.csdnimg.cn/img_convert/c0501ff196f4cea7ca4931235e479dcb.png#id=CC6kB&amp;originHeight=792&amp;originWidth=1193&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>配置源码管理</li><li><img src="https://img-blog.csdnimg.cn/img_convert/787caf3167d459c869cb888c1e8065af.png#id=fYrMX&amp;originHeight=575&amp;originWidth=1470&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>构建触发器：可设置定时构建、WebHooks 触发构建</li><li>构建环境：需要 NodeJs 的可以添加环境，或者直接在脚本中直接通过 node 的位置直接执行</li><li><img src="https://img-blog.csdnimg.cn/img_convert/2ccf4ee74f2e556133d89ed9338771e4.png#id=ShFai&amp;originHeight=662&amp;originWidth=1600&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>build 命令：可指定文件执行 maven 命令</li><li>Post Steps: 可以指定运行脚本等，根据安装的插件可添加很多功能</li><li>构建设置：可设置通知</li><li><img src="https://img-blog.csdnimg.cn/img_convert/1b2c44a52b0de234ba80598afe72986c.png#id=YFVp9&amp;originHeight=801&amp;originWidth=1634&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li></ul><h2 id="kubernetes-部署-nginx-测试" tabindex="-1"><a class="header-anchor" href="#kubernetes-部署-nginx-测试"><span>Kubernetes 部署 Nginx 测试</span></a></h2><p>通过 rancher-cli 进行部署，部署文件的内容：</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> <span class="token string">&quot;default&quot;</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
          <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>1.12.2
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;test-nginx&quot;</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> <span class="token string">&quot;default&quot;</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token string">&quot;test-nginx&quot;</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;80&quot;</span>
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">80</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>nginx.default.172.22.190.240.xip.io
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> test<span class="token punctuation">-</span>nginx
              <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">80</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span>
    <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">ip</span><span class="token punctuation">:</span> 172.22.190.240
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="jenkins-打包-springboot-镜像测试" tabindex="-1"><a class="header-anchor" href="#jenkins-打包-springboot-镜像测试"><span>Jenkins 打包 SpringBoot 镜像测试</span></a></h2><h3 id="设置-jenkins-流水线" tabindex="-1"><a class="header-anchor" href="#设置-jenkins-流水线"><span>设置 Jenkins 流水线</span></a></h3><ul><li>添加源码管理并指定分支</li><li><img src="https://img-blog.csdnimg.cn/img_convert/07a3b50c578607f9279bc2abb4d2c3d7.png#id=Ll9Er&amp;originHeight=588&amp;originWidth=1517&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>项目中使用到了 NodeJs，添加 NodeJs 构建环境</li><li><img src="https://img-blog.csdnimg.cn/img_convert/f6cfebd0d0fd1c3b65649d4f2d153324.png#id=r6NO9&amp;originHeight=407&amp;originWidth=1538&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>执行 Maven 命令进行构建打包</li><li><img src="https://img-blog.csdnimg.cn/img_convert/bde92288e06c6c32d205145b05591cc4.png#id=smevV&amp;originHeight=215&amp;originWidth=1582&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>执行自定义（deploy）制作镜像--&gt;推送镜像---&gt;部署的脚本</li><li><img src="https://img-blog.csdnimg.cn/img_convert/460ed58e8d85267038d0e647da418ee8.png#id=oeiQX&amp;originHeight=421&amp;originWidth=1487&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>点击应用，保存该流水线。</li><li>deploy 内容</li></ul><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">cd</span> ./contract-parent/contract-server <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span>  <span class="token number">172.22</span>.190.250/library/contract:latest <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token function">docker</span> push <span class="token number">172.22</span>.190.250/library/contract:latest <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
/usr/local/bin/rancher kubectl apply <span class="token parameter variable">-f</span> deployment.yaml <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token builtin class-name">cd</span> ./project-parent/project-server <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span>  <span class="token number">172.22</span>.190.250/library/project:latest <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token function">docker</span> push <span class="token number">172.22</span>.190.250/library/project:latest <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
/usr/local/bin/rancher kubectl apply <span class="token parameter variable">-f</span> deployment.yaml <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token builtin class-name">cd</span> ./public-data-parent/public-data-server <span class="token operator">&amp;&amp;</span>  <span class="token punctuation">\\</span>
<span class="token function">docker</span> build <span class="token parameter variable">-t</span>  <span class="token number">172.22</span>.190.250/library/public-data:latest <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token function">docker</span> push <span class="token number">172.22</span>.190.250/library/public-data:latest <span class="token operator">&amp;&amp;</span> /usr/local/bin/rancher kubectl apply <span class="token parameter variable">-f</span> deployment.yaml <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/ <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token builtin class-name">cd</span> ./omgt-web <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> dest <span class="token operator">&amp;&amp;</span> <span class="token function">npm</span> <span class="token function">install</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token function">npm</span> run build <span class="token operator">&amp;&amp;</span> <span class="token function">docker</span> build <span class="token parameter variable">-t</span>  <span class="token number">172.22</span>.190.250/library/omgt-web:latest <span class="token builtin class-name">.</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
<span class="token function">docker</span> push <span class="token number">172.22</span>.190.250/library/omgt-web:latest <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\\</span>
/usr/local/bin/rancher kubectl apply <span class="token parameter variable">-f</span> deployment.yaml <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>/<span class="token punctuation">..</span>/
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>其中一个 Dockerfile 的内容</li></ul><div class="language-latex line-numbers-mode" data-ext="latex" data-title="latex"><pre class="language-latex"><code>FROM anapsix/alpine-java:8_server-jre_unlimited
MAINTAINER 961099916@qq.com
ENV TZ=Asia/Shanghai
RUN ln -sf /usr/share/zoneinfo/<span class="token equation string">$TZ /etc/localtime &amp;&amp; echo $</span>TZ &gt; /etc/timezone
RUN mkdir -p /omgt
WORKDIR /omgt
EXPOSE 8038
ADD ./target/public-data-server.jar ./
CMD sleep 10;java -Djava.security.egd=file:/dev/./urandom -jar public-data-server.jar &gt;&gt; start.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>其中一个 deployment.yaml 的内容</li></ul><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data<span class="token punctuation">-</span>deployment
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> omgt
    <span class="token key atrule">env</span><span class="token punctuation">:</span> dev
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data
      <span class="token key atrule">dept</span><span class="token punctuation">:</span> omgt
      <span class="token key atrule">env</span><span class="token punctuation">:</span> dev
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data
        <span class="token key atrule">dept</span><span class="token punctuation">:</span> omgt
        <span class="token key atrule">env</span><span class="token punctuation">:</span> dev
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> omgt<span class="token punctuation">-</span>public<span class="token punctuation">-</span>data
          <span class="token key atrule">image</span><span class="token punctuation">:</span> 172.22.190.250/library/public<span class="token punctuation">-</span>data<span class="token punctuation">:</span>latest
          <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
          <span class="token key atrule">ports</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8038</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data<span class="token punctuation">-</span>service
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> default
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> omgt
    <span class="token key atrule">env</span><span class="token punctuation">:</span> dev
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;8038&quot;</span>
      <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8038</span>
      <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8038</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> omgt
    <span class="token key atrule">env</span><span class="token punctuation">:</span> dev
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> omgt
  <span class="token key atrule">name</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data<span class="token punctuation">-</span>ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data<span class="token punctuation">-</span>ingress.default.172.22.190.240.xip.io
      <span class="token key atrule">http</span><span class="token punctuation">:</span>
        <span class="token key atrule">paths</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
              <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> public<span class="token punctuation">-</span>data<span class="token punctuation">-</span>service
              <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token number">8038</span>
            <span class="token key atrule">path</span><span class="token punctuation">:</span> /
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span>
    <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">ip</span><span class="token punctuation">:</span> 172.22.190.240
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查看打包过程" tabindex="-1"><a class="header-anchor" href="#查看打包过程"><span>查看打包过程</span></a></h3><ul><li>点击 Build Now 运行流水线</li><li><img src="https://img-blog.csdnimg.cn/img_convert/5137cc7253d2dbb8be17874e2b1795d0.png#id=DaUgQ&amp;originHeight=333&amp;originWidth=302&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>点击历史可进入正在运行的流水线</li><li><img src="https://img-blog.csdnimg.cn/img_convert/f02181d2bd9668b0798e469c7b5921a8.png#id=m72yr&amp;originHeight=185&amp;originWidth=408&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li><li>通过控制台进行查看流水线日志</li><li><img src="https://img-blog.csdnimg.cn/img_convert/6063e8220ccf8374ca0eb73ed3f6171d.png#id=rbai7&amp;originHeight=357&amp;originWidth=293&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li></ul><h3 id="查看-kubernetes-集群中是否部署成功" tabindex="-1"><a class="header-anchor" href="#查看-kubernetes-集群中是否部署成功"><span>查看 Kubernetes 集群中是否部署成功</span></a></h3><ul><li>查看指定的命名空间和服务名称</li><li><img src="https://img-blog.csdnimg.cn/img_convert/d5c34862297264db309bb5e4022fcb11.png#id=T7FlF&amp;originHeight=430&amp;originWidth=1466&amp;originalType=binary&amp;ratio=1&amp;rotation=0&amp;showTitle=false&amp;status=done&amp;style=none&amp;title=" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></li></ul><h2 id="后记" tabindex="-1"><a class="header-anchor" href="#后记"><span>后记</span></a></h2><p>部署文件的编写可能需要学习 Kubernetes 才能编写，而次次重新编写可能过于麻烦，可通过<code>cookiecutter</code>进行模板化生成</p><h3 id="_1-安装-cookiecutter" tabindex="-1"><a class="header-anchor" href="#_1-安装-cookiecutter"><span>1.安装 cookiecutter</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>pip <span class="token function">install</span> cookiecutter
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="_2-编写配置文件" tabindex="-1"><a class="header-anchor" href="#_2-编写配置文件"><span>2.编写配置文件</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 创建文件</span>
<span class="token function">mkdir</span> cookiecutter.json
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>cookiecutter 内容如下：</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;project&quot;</span><span class="token operator">:</span> <span class="token string">&quot;kubernetes&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;dept&quot;</span><span class="token operator">:</span> <span class="token string">&quot;omgt&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;env&quot;</span><span class="token operator">:</span> <span class="token string">&quot;dev&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;namespace&quot;</span><span class="token operator">:</span> <span class="token string">&quot;default&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;app_name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nginx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;app_port&quot;</span><span class="token operator">:</span> <span class="token string">&quot;8080&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;app_replicas&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;app_image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nginx&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;app_image_version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;latest&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;lbip&quot;</span><span class="token operator">:</span> <span class="token string">&quot;192.168.1.3&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-创建模版文件" tabindex="-1"><a class="header-anchor" href="#_3-创建模版文件"><span>3.创建模版文件</span></a></h3><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.project<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token function">touch</span> default_dev.yaml
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>default_dev.yaml 内容如下：</p><div class="language-yaml line-numbers-mode" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>deployment
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.namespace<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.dept<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">env</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.env<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_replicas<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token key atrule">dept</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.dept<span class="token punctuation">}</span><span class="token punctuation">}</span>
      <span class="token key atrule">env</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.env<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">dept</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.dept<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">env</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.env<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_image<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_image_version<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_port<span class="token punctuation">}</span><span class="token punctuation">}</span>


<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>service
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.namespace<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.dept<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">env</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.env<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;{{cookiecutter.app_port}}&quot;</span>
    <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_port<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_port<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">dept</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.dept<span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token key atrule">env</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.env<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> extensions/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
     <span class="token key atrule">app</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span>
     <span class="token key atrule">dept</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.dept<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>ingress

<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>ingress.<span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.namespace<span class="token punctuation">}</span><span class="token punctuation">}</span>.<span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.lbip<span class="token punctuation">}</span><span class="token punctuation">}</span>.xip.io
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">serviceName</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">-</span>service
          <span class="token key atrule">servicePort</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.app_port<span class="token punctuation">}</span><span class="token punctuation">}</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /
<span class="token key atrule">status</span><span class="token punctuation">:</span>
  <span class="token key atrule">loadBalancer</span><span class="token punctuation">:</span>
    <span class="token key atrule">ingress</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">ip</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>cookiecutter.lbip<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,42);function g(h,y){const s=p("ExternalLinkIcon");return l(),o("div",null,[r,n("ul",null,[n("li",null,[a("linux 下载链接："),n("a",u,[a("https://releases.rancher.com/cli2/v2.4.3/rancher-linux-amd64-v2.4.3.tar.gz"),e(s)])]),n("li",null,[a("window 下载链接："),n("a",d,[a("https://releases.rancher.com/cli2/v2.4.3/rancher-windows-386-v2.4.3.zip"),e(s)])]),n("li",null,[a("MacOS 下载链接："),n("a",m,[a("https://releases.rancher.com/cli2/v2.4.3/rancher-darwin-amd64-v2.4.3.tar.gz"),e(s)])])]),k,n("p",null,[a("执行 "),n("a",v,[a("install.sh"),e(s)]),a(" 报以下错误")]),b])}const x=i(c,[["render",g],["__file","operation-cloudplatform.html.vue"]]),T=JSON.parse('{"path":"/%E8%BF%90%E7%BB%B4/operation-cloudplatform.html","title":"云平台搭建","lang":"zh-CN","frontmatter":{"title":"云平台搭建","date":"2024-02-18T00:00:00.000Z","description":"云平台主要采用的技术如下： 环境准备 1.关闭防火墙 2.更新 yum 3.安装工具 安装 Docker 1. 设置开机启动 2.使用阿里加速 安装 Rancher 如果映射端口为 80、443 可能会导致无法访问，更换端口即可 安装 Kubernetes 1.创建集群 添加集群 选择自定义，然后填写创建的配置，点击下一步 添加节点 2.安装 mast...","head":[["meta",{"property":"og:url","content":"https://961099916.github.io/%E8%BF%90%E7%BB%B4/operation-cloudplatform.html"}],["meta",{"property":"og:site_name","content":"九夏的博客"}],["meta",{"property":"og:title","content":"云平台搭建"}],["meta",{"property":"og:description","content":"云平台主要采用的技术如下： 环境准备 1.关闭防火墙 2.更新 yum 3.安装工具 安装 Docker 1. 设置开机启动 2.使用阿里加速 安装 Rancher 如果映射端口为 80、443 可能会导致无法访问，更换端口即可 安装 Kubernetes 1.创建集群 添加集群 选择自定义，然后填写创建的配置，点击下一步 添加节点 2.安装 mast..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://img-blog.csdnimg.cn/img_convert/08b16a99f99d283943e901e6538175c9.png#id=DlN8G&originHeight=429&originWidth=3017&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title="}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-04-14T10:26:17.000Z"}],["meta",{"property":"article:author","content":"九夏"}],["meta",{"property":"article:published_time","content":"2024-02-18T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-04-14T10:26:17.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"云平台搭建\\",\\"image\\":[\\"https://img-blog.csdnimg.cn/img_convert/08b16a99f99d283943e901e6538175c9.png#id=DlN8G&originHeight=429&originWidth=3017&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/2c3d4296756fca322c8b4fa8f2d714ba.png#id=MIBAN&originHeight=1648&originWidth=3073&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/917da469670cd455c0add3a09cad4f67.png#id=VjeVb&originHeight=731&originWidth=3009&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/9fe828979b7ec9d3ca8aa68f3f4def65.png#id=TfICt&originHeight=487&originWidth=1400&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/c2354ae8e881435897dd9416e058cd7c.png#id=jX3Bn&originHeight=640&originWidth=3019&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/4d10fe0ab8bf67f05ec54be4405f760a.png#id=rRBSm&originHeight=673&originWidth=1175&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/ef906bee1b727ee324f4980ecce5ea07.png#id=uPRzP&originHeight=1891&originWidth=3511&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/d138925af8b3793e0f702bbf3a96b8b3.png#id=pvaOC&originHeight=587&originWidth=383&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/c0501ff196f4cea7ca4931235e479dcb.png#id=CC6kB&originHeight=792&originWidth=1193&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/787caf3167d459c869cb888c1e8065af.png#id=fYrMX&originHeight=575&originWidth=1470&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/2ccf4ee74f2e556133d89ed9338771e4.png#id=ShFai&originHeight=662&originWidth=1600&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/1b2c44a52b0de234ba80598afe72986c.png#id=YFVp9&originHeight=801&originWidth=1634&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/07a3b50c578607f9279bc2abb4d2c3d7.png#id=Ll9Er&originHeight=588&originWidth=1517&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/f6cfebd0d0fd1c3b65649d4f2d153324.png#id=r6NO9&originHeight=407&originWidth=1538&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/bde92288e06c6c32d205145b05591cc4.png#id=smevV&originHeight=215&originWidth=1582&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/460ed58e8d85267038d0e647da418ee8.png#id=oeiQX&originHeight=421&originWidth=1487&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/5137cc7253d2dbb8be17874e2b1795d0.png#id=DaUgQ&originHeight=333&originWidth=302&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/f02181d2bd9668b0798e469c7b5921a8.png#id=m72yr&originHeight=185&originWidth=408&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/6063e8220ccf8374ca0eb73ed3f6171d.png#id=rbai7&originHeight=357&originWidth=293&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\",\\"https://img-blog.csdnimg.cn/img_convert/d5c34862297264db309bb5e4022fcb11.png#id=T7FlF&originHeight=430&originWidth=1466&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=\\"],\\"datePublished\\":\\"2024-02-18T00:00:00.000Z\\",\\"dateModified\\":\\"2024-04-14T10:26:17.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"九夏\\",\\"url\\":\\"https://blog.jiuxialb.top/\\"}]}"]]},"headers":[{"level":2,"title":"环境准备","slug":"环境准备","link":"#环境准备","children":[{"level":3,"title":"1.关闭防火墙","slug":"_1-关闭防火墙","link":"#_1-关闭防火墙","children":[]},{"level":3,"title":"2.更新 yum","slug":"_2-更新-yum","link":"#_2-更新-yum","children":[]},{"level":3,"title":"3.安装工具","slug":"_3-安装工具","link":"#_3-安装工具","children":[]}]},{"level":2,"title":"安装 Docker","slug":"安装-docker","link":"#安装-docker","children":[{"level":3,"title":"1. 设置开机启动","slug":"_1-设置开机启动","link":"#_1-设置开机启动","children":[]},{"level":3,"title":"2.使用阿里加速","slug":"_2-使用阿里加速","link":"#_2-使用阿里加速","children":[]}]},{"level":2,"title":"安装 Rancher","slug":"安装-rancher","link":"#安装-rancher","children":[]},{"level":2,"title":"安装 Kubernetes","slug":"安装-kubernetes","link":"#安装-kubernetes","children":[{"level":3,"title":"1.创建集群","slug":"_1-创建集群","link":"#_1-创建集群","children":[]},{"level":3,"title":"2.安装 master","slug":"_2-安装-master","link":"#_2-安装-master","children":[]},{"level":3,"title":"3.安装 node","slug":"_3-安装-node","link":"#_3-安装-node","children":[]},{"level":3,"title":"4.笔记本合盖","slug":"_4-笔记本合盖","link":"#_4-笔记本合盖","children":[]},{"level":3,"title":"5.主机名","slug":"_5-主机名","link":"#_5-主机名","children":[]}]},{"level":2,"title":"Rancher-cli 工具使用","slug":"rancher-cli-工具使用","link":"#rancher-cli-工具使用","children":[{"level":3,"title":"通过 UI 添加 token","slug":"通过-ui-添加-token","link":"#通过-ui-添加-token","children":[]},{"level":3,"title":"使用","slug":"使用","link":"#使用","children":[]},{"level":3,"title":"安装 kubectl","slug":"安装-kubectl","link":"#安装-kubectl","children":[]}]},{"level":2,"title":"安装 Harbor","slug":"安装-harbor","link":"#安装-harbor","children":[{"level":3,"title":"配置 Harbor","slug":"配置-harbor","link":"#配置-harbor","children":[]},{"level":3,"title":"启动 Harbor","slug":"启动-harbor","link":"#启动-harbor","children":[]},{"level":3,"title":"注意","slug":"注意","link":"#注意","children":[]}]},{"level":2,"title":"安装 Jenkins","slug":"安装-jenkins","link":"#安装-jenkins","children":[{"level":3,"title":"提升权限","slug":"提升权限","link":"#提升权限","children":[]},{"level":3,"title":"设置环境","slug":"设置环境","link":"#设置环境","children":[]},{"level":3,"title":"配置 Jenkins 插件工具","slug":"配置-jenkins-插件工具","link":"#配置-jenkins-插件工具","children":[]},{"level":3,"title":"设置流水线","slug":"设置流水线","link":"#设置流水线","children":[]}]},{"level":2,"title":"Kubernetes 部署 Nginx 测试","slug":"kubernetes-部署-nginx-测试","link":"#kubernetes-部署-nginx-测试","children":[]},{"level":2,"title":"Jenkins 打包 SpringBoot 镜像测试","slug":"jenkins-打包-springboot-镜像测试","link":"#jenkins-打包-springboot-镜像测试","children":[{"level":3,"title":"设置 Jenkins 流水线","slug":"设置-jenkins-流水线","link":"#设置-jenkins-流水线","children":[]},{"level":3,"title":"查看打包过程","slug":"查看打包过程","link":"#查看打包过程","children":[]},{"level":3,"title":"查看 Kubernetes 集群中是否部署成功","slug":"查看-kubernetes-集群中是否部署成功","link":"#查看-kubernetes-集群中是否部署成功","children":[]}]},{"level":2,"title":"后记","slug":"后记","link":"#后记","children":[{"level":3,"title":"1.安装 cookiecutter","slug":"_1-安装-cookiecutter","link":"#_1-安装-cookiecutter","children":[]},{"level":3,"title":"2.编写配置文件","slug":"_2-编写配置文件","link":"#_2-编写配置文件","children":[]},{"level":3,"title":"3.创建模版文件","slug":"_3-创建模版文件","link":"#_3-创建模版文件","children":[]}]}],"git":{"createdTime":1713090377000,"updatedTime":1713090377000,"contributors":[{"name":"zhangjiahao","email":"961099916@qq.com","commits":1}]},"readingTime":{"minutes":8.47,"words":2540},"filePathRelative":"运维/operation-cloudplatform.md","localizedDate":"2024年2月18日","excerpt":"<p>云平台主要采用的技术如下：</p>\\n<table>\\n<thead>\\n<tr>\\n<th>名称</th>\\n<th>简介</th>\\n</tr>\\n</thead>\\n<tbody>\\n<tr>\\n<td>Docker</td>\\n<td>应用容器引擎，从而实现同一应用运行在任何地方</td>\\n</tr>\\n<tr>\\n<td>Kubernetes</td>\\n<td>容器化编排工具，能够实现容器化的集群部署</td>\\n</tr>\\n<tr>\\n<td>Rancher</td>\\n<td>Kubernetes 管理工具，能够快速搭建高可用 Kubernetes 和搭建部分常用服务</td>\\n</tr>\\n<tr>\\n<td>Harbor</td>\\n<td>私有镜像仓库</td>\\n</tr>\\n<tr>\\n<td>Jenkins</td>\\n<td>持续集成工具</td>\\n</tr>\\n</tbody>\\n</table>","autoDesc":true}');export{x as comp,T as data};
